require("../../common/manifest.js");
require("../../common/vendor.js");
global.webpackJsonp([0],[,,,,,,,,function(t,e,i){"use strict";var n=o(i(9)),s=o(i(10));function o(t){return t&&t.__esModule?t:{default:t}}Page((0,n.default)(s.default))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e;return a(e={data:{$root:{}},onLoad:function(e){var i=new o.default(t);this.$vm=i;var n=i.$root;n.__wxWebviewId__=this.__wxWebviewId__,n.$mp||(n.$mp={});var s=n.$mp;s.mpType="page",s.page=this,s.query=e,s.status="load",i.$mount()},handleProxy:function(t){return c(this).$handleProxyWithVue(t)},onShow:function(){var t=c(this);t.$mp.status="show",r(t,"onShow"),t.$nextTick(function(){t._initDataToMP()})},onReady:function(){var t=c(this);t.$mp.status="ready",r(t,"onReady")},onHide:function(){var t=c(this);t.$mp.status="hide",r(t,"onHide")},onUnload:function(){var t=c(this);r(t,"onUnload"),t.$destroy()},onPullDownRefresh:function(){r(c(this),"onPullDownRefresh")},onReachBottom:function(){r(c(this),"onReachBottom")},onPageScroll:function(t){r(c(this),"onPageScroll",t)},onTabItemTap:function(t){r(c(this),"onTabItemTap",t)}},"onPullDownRefresh",function(){r(c(this),"onPullDownRefresh")}),a(e,"onReachBottom",function(){r(c(this),"onReachBottom")}),a(e,"onShareAppMessage",t.onShareAppMessage?function(t){return r(c(this),"onShareAppMessage",t)}:null),a(e,"onPageScroll",function(t){r(c(this),"onPageScroll",t)}),a(e,"onTabItemTap",function(t){r(c(this),"onTabItemTap",t)}),a(e,"onNavigationBarButtonTap",function(t){r(c(this),"onNavigationBarButtonTap",t)}),a(e,"onBackPress",function(){return r(c(this),"onBackPress")}),a(e,"$getAppWebview",function(t){return plus.webview.getWebviewById(""+this.__wxWebviewId__)}),e};var n,s=i(0),o=(n=s)&&n.__esModule?n:{default:n};function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function r(t,e,i){var n,s=t.$options[e];if("onError"===e&&s&&(s=[s]),s)for(var o=0,a=s.length;o<a;o++)n=s[o].call(t,i);return t._hasHookEvent&&t.$emit("hook:"+e),t.$children.length&&t.$children.forEach(function(t){return r(t,e,i)}),n}function c(t){return t.$vm.$root}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(12),s=i.n(n),o=i(15),a=!1;var r=function(t){a||i(11)},c=i(1)(s.a,o.a,r,"data-v-7eb4792f",null);c.options.__file="..\\..\\..\\..\\Users\\Admin\\Documents\\HBuilderProjects\\signature\\pages\\index\\index.vue",c.esModule&&Object.keys(c.esModule).some(function(t){return"default"!==t&&"__"!==t.substr(0,2)})&&console.error("named exports are not supported in *.vue files."),c.options.functional&&console.error("[vue-loader] index.vue: functional components are not supported with templates, they should use render functions."),e.default=c.exports},function(t,e){},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,s=i(21),o=(n=s)&&n.__esModule?n:{default:n};e.default={data:function(){return{lineColor:"black",slideValue:50,handwriting:"",selectColor:"black",color:"",showimg:"",share_popup:!1}},onLoad:function(){this.handwriting=new o.default({lineColor:this.lineColor,slideValue:this.slideValue,canvasName:"handWriting"})},methods:{selectColorEvent:function(t){this.selectColor=t,"black"==t?this.color="#1A1A1A":"red"==t&&(this.color="#ca262a"),this.handwriting.selectColorEvent(this.color)},retDraw:function(){this.handwriting.retDraw()},updateValue:function(t){console.log(t.detail),this.slideValue=t.detail.value,this.handwriting.selectSlideValue(this.slideValue)},uploadScaleStart:function(t){this.handwriting.uploadScaleStart(t)},uploadScaleMove:function(t){this.handwriting.uploadScaleMove(t)},uploadScaleEnd:function(t){this.handwriting.uploadScaleEnd(t)},subCanvas:function(){var t=this;this.handwriting.saveCanvas().then(function(e){t.showimg=e,console.log(e)}).catch(function(t){console.log(t)})}}}},,function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return"function"==typeof t},s=/^on|^create|Sync$|Manager$|^pause/,o=["os","stopRecord","stopVoice","stopBackgroundAudio","stopPullDownRefresh","hideKeyboard","hideToast","hideLoading","showNavigationBarLoading","hideNavigationBarLoading","canIUse","navigateBack","closeSocket","pageScrollTo","drawCanvas"],a=function(t){return(!s.test(t)||"createBLEConnection"===t)&&!~o.indexOf(t)},r=function(t){return function(){for(var e=arguments.length,i=Array(e>1?e-1:0),s=1;s<e;s++)i[s-1]=arguments[s];var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n(o.success)||n(o.fail)||n(o.complete)?t.apply(void 0,[o].concat(i)):new Promise(function(e,n){t.apply(void 0,[Object.assign({},o,{success:e,fail:n})].concat(i)),Promise.prototype.finally=function(t){var e=this.constructor;return this.then(function(i){return e.resolve(t()).then(function(){return i})},function(i){return e.resolve(t()).then(function(){throw i})})}}).then(function(t){return[null,t]}).catch(function(t){return[t]})}},c=1e-4,l=750,u=!1,h=0,d=0;function f(t,e){var i,n,s,o;return 0===h&&(i=wx.getSystemInfoSync(),n=i.platform,s=i.pixelRatio,o=i.windowWidth,h=o,d=s,u="ios"===n),0===t?0:(t=t/l*(e||h),0===(t=Math.floor(t+c))?1!==d&&u?.5:1:t)}var v={oauth:["weixin"],share:["weixin"],payment:["wxpay"],push:["weixin"]};var p=Object.freeze({getProvider:function(t){var e=t.service,i=t.success,s=t.fail,o=t.complete,a=!1;v[e]?(a={errMsg:"getProvider:ok",service:e,provider:v[e]},n(i)&&i(a)):(a={errMsg:"getProvider:fail:服务["+e+"]不存在"},n(s)&&s(a)),n(o)&&o(a)},subscribePush:function(t){var e=t.fail,i=t.complete,s={errMsg:"subscribePush:fail:微信小程序不支持 subscribePush 方法"};n(e)&&e(s),n(i)&&i(s)},unsubscribePush:function(t){var e=t.fail,i=t.complete,s={errMsg:"unsubscribePush:fail:微信小程序不支持 unsubscribePush 方法"};n(e)&&e(s),n(i)&&i(s)},onPush:function(t){var e=t.fail,i=t.complete,s={errMsg:"onPush:fail:微信小程序不支持 onPush 方法"};n(e)&&e(s),n(i)&&i(s)},offPush:function(t){var e=t.fail,i=t.complete,s={errMsg:"offPush:fail:微信小程序不支持 offPush 方法"};n(e)&&e(s),n(i)&&i(s)},share:function(t){var e=t.fail,i=t.complete,s={errMsg:"share:fail:微信小程序不支持 share 方法"};n(e)&&e(s),n(i)&&i(s)}}),x={},y={os:{wx:!0}};"undefined"!=typeof Proxy?x=new Proxy({},{get:function(t,e){return y.hasOwnProperty(e)?y[e]:"upx2px"===e?f:p[e]?a(e)?r(p[e]):p[e]:wx.hasOwnProperty(e)?a(e)?r(wx[e]):wx[e]:void 0}}):(x.upx2px=f,Object.keys(y).forEach(function(t){x[t]=y[t]}),Object.keys(p).forEach(function(t){a(t)?x[t]=p[t]:x[t]=r(p[t])}),Object.keys(wx).forEach(function(t){wx.hasOwnProperty(t)&&(a(t)?x[t]=r(wx[t]):x[t]=wx[t])}));var g=x;e.default=g},function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",{staticClass:"wrapper"},[t._m(0),i("view",{staticClass:"handBtn"},[i("view",{staticClass:"slide-wrapper"},[i("text",[t._v("选择粗细")]),i("slider",{staticClass:"slider",attrs:{value:"50","show-value":"",step:"25",eventid:"5Px-0"},on:{change:t.updateValue}})]),i("view",{staticClass:"color"},[i("text",[t._v("选择颜色")]),i("image",{staticClass:"black-select",class:"black"===t.selectColor?"color_select":"",attrs:{src:"black"===t.selectColor?"../../static/img/color_black_selected.png":"../../static/img/color_black.png",eventid:"eEj-1"},on:{click:function(e){t.selectColorEvent("black")}}}),i("image",{staticClass:"red-select",class:"red"===t.selectColor?"color_select":"",attrs:{src:"red"===t.selectColor?"../../static/img/color_red_selected.png":"../../static/img/color_red.png",eventid:"K4y-2"},on:{click:function(e){t.selectColorEvent("red")}}})])]),i("view",{staticClass:"handCenter"},[i("canvas",{staticClass:"handWriting",attrs:{"disable-scroll":"true","canvas-id":"handWriting",eventid:"pRx-3"},on:{touchstart:t.uploadScaleStart,touchmove:t.uploadScaleMove,touchend:t.uploadScaleEnd,tap:t.mouseDown}})]),i("view",{staticClass:"showimg"},[t.showimg?i("image",{attrs:{src:t.showimg,mode:""}}):i("text",[t._v("图片展示")])]),i("view",{staticClass:"buttons"},[i("button",{staticClass:"delBtn",attrs:{eventid:"YKe-4"},on:{click:t.retDraw}},[t._v("重写")]),i("button",{staticClass:"subBtn",attrs:{eventid:"eov-5"},on:{click:t.subCanvas}},[t._v("保存")])],1)])};n._withStripped=!0;var s={render:n,staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("view",{staticClass:"handRight"},[e("view",{staticClass:"handTitle"},[this._v("手写板")])])}]};e.a=s},,,,,,function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var n=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.ctx="",this.canvasWidth=300,this.canvasHeight=900,this.linePrack=[],this.currentLine=[],this.transparent=1,this.pressure=.5,this.smoothness=100,this.lineSize=1.5,this.lineMin=.5,this.lineMax=2,this.currentPoint={},this.firstTouch=!0,this.radius=1,this.cutArea={top:0,right:0,bottom:0,left:0},this.lastPoint=0,this.chirography=[],this.startY=0,this.deltaY=0,this.startValue=0,console.log(t),this.lineColor=t.lineColor||"#1A1A1A",this.slideValue=t.slideValue||50,this.canvasName=t.canvasName||"handWriting",this.init()}return i(e,[{key:"init",value:function(){var e=this;this.ctx=t.createCanvasContext(this.canvasName),t.createSelectorQuery().select(".handCenter").boundingClientRect(function(t){console.log(t),e.canvasWidth=t.width,e.canvasHeight=t.height}).exec(),this.selectSlideValue(this.slideValue)}},{key:"uploadScaleStart",value:function(t){console.log("start");var e=t.mp;if(console.log(e.touches[0]),"touchstart"!=e.type)return!1;this.ctx.setFillStyle(this.lineColor),this.ctx.setGlobalAlpha(this.transparent),this.currentPoint={x:e.touches[0].x,y:e.touches[0].y},this.currentLine.unshift({time:(new Date).getTime(),dis:0,x:this.currentPoint.x,y:this.currentPoint.y}),this.firstTouch&&(this.cutArea={top:this.currentPoint.y,right:this.currentPoint.x,bottom:this.currentPoint.y,left:this.currentPoint.x},this.firstTouch=!1),this.pointToLine(this.currentLine)}},{key:"uploadScaleMove",value:function(t){console.log("move");var e=t.mp;if("touchmove"!=e.type)return!1;e.cancelable&&(e.defaultPrevented||e.preventDefault());var i={x:e.touches[0].x,y:e.touches[0].y};i.y<this.cutArea.top&&(this.cutArea.top=i.y),i.y<0&&(this.cutArea.top=0),i.x>this.cutArea.right&&(this.cutArea.right=i.x),this.canvasWidth-i.x<=0&&(this.cutArea.right=this.canvasWidth),i.y>this.cutArea.bottom&&(this.cutArea.bottom=i.y),this.canvasHeight-i.y<=0&&(this.cutArea.bottom=this.canvasHeight),i.x<this.cutArea.left&&(this.cutArea.left=i.x),i.x<0&&(this.cutArea.left=0),this.lastPoint=this.currentPoint,this.currentPoint=i,this.currentLine.unshift({time:(new Date).getTime(),dis:this.distance(this.currentPoint,this.lastPoint,"move"),x:i.x,y:i.y}),this.pointToLine(this.currentLine)}},{key:"uploadScaleEnd",value:function(t){var e=t.mp;if("touchend"!=e.type)return 0;console.log(e);var i={x:e.changedTouches[0].x,y:e.changedTouches[0].y};if(this.lastPoint=this.currentPoint,this.currentPoint=i,this.currentLine.unshift({time:(new Date).getTime(),dis:this.distance(this.currentPoint,this.lastPoint,"end"),x:i.x,y:i.y}),this.currentLine.length>2)this.currentLine[0].time,this.currentLine[this.currentLine.length-1].time,this.currentLine.length;this.pointToLine(this.currentLine);var n={lineSize:this.lineSize,lineColor:this.lineColor};this.chirography.unshift(n),this.linePrack.unshift(this.currentLine),this.currentLine=[]}},{key:"retDraw",value:function(){this.ctx.clearRect(0,0,700,730),this.ctx.draw()}},{key:"pointToLine",value:function(t){this.calcBethelLine(t)}},{key:"calcBethelLine",value:function(t){if(t.length<=1)t[0].r=this.radius;else{var e,i,n=void 0,s=void 0,o=void 0,a=void 0,r=void 0,c=void 0,l=0,u=0;t.length<=2?(n=t[1].x,a=t[1].y,s=n+.5*((o=t[1].x+.5*(t[0].x-t[1].x))-n),r=a+.5*((c=t[1].y+.5*(t[0].y-t[1].y))-a)):(n=t[2].x+.5*(t[1].x-t[2].x),a=t[2].y+.5*(t[1].y-t[2].y),s=t[1].x,r=t[1].y,o=s+.5*(t[0].x-s),c=r+.5*(t[0].y-r)),e=this.distance({x:o,y:c},{x:n,y:a},"calc"),i=this.radius;for(var h=0;h<t.length-1&&(l+=t[h].dis,u+=t[h].time-t[h+1].time,!(l>this.smoothness));h++);this.radius=Math.min(u/e*this.pressure+this.lineMin,this.lineMax)*this.lineSize,t[0].r=this.radius,t.length<=2?(i+this.radius)/2:((t[2].r+t[1].r)/2,t[1].r,(t[1].r+t[0].r)/2);for(var d=[],f=0;f<5;f++){var v=f/4,p=(1-v)*(1-v)*n+2*v*(1-v)*s+v*v*o,x=(1-v)*(1-v)*a+2*v*(1-v)*r+v*v*c,y=i+(this.radius-i)/5*f;if(d.push({x:p,y:x,r:y}),3==d.length){var g=this.ctaCalc(d[0].x,d[0].y,d[0].r,d[1].x,d[1].y,d[1].r,d[2].x,d[2].y,d[2].r);g[0].color=this.lineColor,this.bethelDraw(g,1),d=[{x:p,y:x,r:y}]}}}}},{key:"distance",value:function(t,e,i){var n=e.x-t.x,s=e.y-t.y;return 5*Math.sqrt(n*n+s*s)}},{key:"ctaCalc",value:function(t,e,i,n,s,o,a,r,c){var l,u,h,d,f=[],v=void 0,p=void 0,x=void 0,y=void 0,g=void 0;v=n-t,l=p=(p=s-e)/(x=2*Math.sqrt(v*v+p*p+1e-4))*i,u=-(v=v/x*i),y=n-a,h=-(g=(g=s-r)/(x=2*Math.sqrt(y*y+g*g+1e-4))*c),d=y=y/x*c,f.push({mx:t+l,my:e+u,color:"#1A1A1A"}),f.push({c1x:n+l,c1y:s+u,c2x:n+h,c2y:s+d,ex:a+h,ey:r+d}),f.push({c1x:a+h-y,c1y:r+d-g,c2x:a-h-y,c2y:r-d-g,ex:a-h,ey:r-d}),f.push({c1x:n-h,c1y:s-d,c2x:n-l,c2y:s-u,ex:t-l,ey:e-u}),f.push({c1x:t-l-v,c1y:e-u-p,c2x:t+l-v,c2y:e+u-p,ex:t+l,ey:e+u}),f[0].mx=f[0].mx.toFixed(1),f[0].mx=parseFloat(f[0].mx),f[0].my=f[0].my.toFixed(1),f[0].my=parseFloat(f[0].my);for(var m=1;m<f.length;m++)f[m].c1x=f[m].c1x.toFixed(1),f[m].c1x=parseFloat(f[m].c1x),f[m].c1y=f[m].c1y.toFixed(1),f[m].c1y=parseFloat(f[m].c1y),f[m].c2x=f[m].c2x.toFixed(1),f[m].c2x=parseFloat(f[m].c2x),f[m].c2y=f[m].c2y.toFixed(1),f[m].c2y=parseFloat(f[m].c2y),f[m].ex=f[m].ex.toFixed(1),f[m].ex=parseFloat(f[m].ex),f[m].ey=f[m].ey.toFixed(1),f[m].ey=parseFloat(f[m].ey);return f}},{key:"bethelDraw",value:function(t,e,i){this.ctx.beginPath(),this.ctx.moveTo(t[0].mx,t[0].my),void 0!=i?(this.ctx.setFillStyle(i),this.ctx.setStrokeStyle(i)):(this.ctx.setFillStyle(t[0].color),this.ctx.setStrokeStyle(t[0].color));for(var n=1;n<t.length;n++)this.ctx.bezierCurveTo(t[n].c1x,t[n].c1y,t[n].c2x,t[n].c2y,t[n].ex,t[n].ey);this.ctx.stroke(),void 0!=e&&this.ctx.fill(),this.ctx.draw(!0)}},{key:"selectColorEvent",value:function(t){this.lineColor=t}},{key:"selectSlideValue",value:function(t){switch(t){case 0:this.lineSize=.1,this.lineMin=.1,this.lineMax=.1;break;case 25:this.lineSize=1,this.lineMin=.5,this.lineMax=2;break;case 50:this.lineSize=1.5,this.lineMin=1,this.lineMax=3;break;case 75:this.lineSize=1.5,this.lineMin=2,this.lineMax=3.5;break;case 100:this.lineSize=3,this.lineMin=2,this.lineMax=3.5}}},{key:"saveCanvas",value:function(){var e=this;return new Promise(function(i,n){t.canvasToTempFilePath({canvasId:e.canvasName,success:function(t){console.log(t.tempFilePath),i(t.tempFilePath)},fail:function(t){console.log("图片生成失败："+t),n(t)}})})}}]),e}();e.default=n}).call(e,i(14).default)}],[8]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/index/index.js.map